(function(d){var c={config:{selector:"select.tl_tagsinput, select.tagsinput, input.tl_tagsinput, input.tagsinput"},init:function(){this.setupTagsInput()},ajaxComplete:function(){this.setupTagsInput()},setupTagsInput:function(){var f=d(this.config.selector);f.each(function(){var p=d(this);if(p.data("tagsinput")){return true}var s=p.data("placeholder"),n=p.data("mode"),g=p.data("post-data"),t={queryTokenizer:Bloodhound.tokenizers.whitespace,datumTokenizer:Bloodhound.tokenizers.obj.whitespace("label"),limit:10},m=p.data();function o(v,u){g.query=v;u.type="POST";u.data=g;u.isTagsInputCallback=true;return u}function i(u){return u}var k={itemValue:function(u){return u.value},itemText:function(u){return u.label},itemTitle:function(u){return u.title},typeaheadjs:{name:"options",displayKey:"label",highlight:true,limit:10},confirmKeys:[9,13,188],tagClass:function(u){return u.className?u.className:"label label-info"}};var h=d.extend({},k,m);switch(n){case"local":t.local=p.data("items");t.identify=function(u){return u.value};break;case"remote":t.remote={url:location.href,prepare:o,transform:i,rateLimitBy:"debounce",rateLimitWait:300};break}var r=new Bloodhound(t);r.initialize();h.typeaheadjs.source=r.ttAdapter();var q=p.tagsinput(h);p.siblings(".bootstrap-tagsinput").addClass("tl_select");if(typeof s==="undefined"||s.length>0){p.tagsinput("input").attr("placeholder",s)}var j=p.tagsinput("input").width();if(p.is("select")){p.find("option:selected").each(function(){p.tagsinput("add",{value:this.value,label:this.text,className:this.className,title:this.value})})}p.tagsinput("input").on("keydown",function(u){if(u.keyCode==9){if(this.value!=""&&h.freeInput){p.tagsinput("add",{value:this.value,label:this.value,title:this.value})}u.preventDefault();if(typeof s==="undefined"||s.length>0){p.tagsinput("input").width(j)}}});if(p.data("submitonchange")=="1"){p.on("itemAdded",function(u){p.closest("form").submit()})}p.tagsinput("input").on("blur",function(u){if(this.value!=""&&h.freeInput){p.tagsinput("add",{value:this.value,label:this.value,title:this.value});this.value="";if(typeof s==="undefined"||s.length>0){p.tagsinput("input").width(j)}}});p.on("itemAdded",function(u){if(typeof s==="undefined"||s.length>0){p.tagsinput("input").val("")}});if(h.maxTags!=1){var l=new Sortable(p.prev(".bootstrap-tagsinput").get(0),{handle:".tag",onUpdate:function(v){var u=p.find("option");if(u.length){p.html(u.move(v.oldIndex,v.newIndex))}}})}})}};d.fn.move=function(h,f){while(h<0){h+=this.length}while(f<0){f+=this.length}if(f>=this.length){var g=f-this.length;while((g--)+1){this.push(undefined)}}this.splice(f,0,this.splice(h,1)[0]);return this};d(function(){c.init()});d(document).ajaxComplete(function(g,h,f){if(typeof f!="undefined"&&!f.isTagsInputCallback){c.ajaxComplete()}});if(window.MooTools){var a=[Request,Request.Contao,Request.HTML,Request.JSON],e={onSuccess:Request.prototype.onSuccess,onFailure:Request.prototype.onFailure},b={onSuccess:function(){Request.Spy&&typeof Request.Spy=="function"&&Request.Spy.apply(this,arguments);e.onSuccess.apply(this,arguments);c.ajaxComplete()},onFailure:function(){Request.Spy&&typeof Request.Spy=="function"&&Request.Spy.apply(this,arguments);e.onFailure.apply(this,arguments)}};a.invoke("implement",b)}})(jQuery);