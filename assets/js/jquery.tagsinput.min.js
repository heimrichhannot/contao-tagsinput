(function(d){var c={config:{selector:"select.tl_tagsinput, select.tagsinput, input.tl_tagsinput, input.tagsinput",},init:function(){this.setupTagsInput();this.setupTagList()},ajaxComplete:function(){this.setupTagsInput();this.setupTagList()},setupTagsInput:function(){var f=d(this.config.selector);f.each(function(){var r=d(this);if(r.data("tagsinput")){return true}var u=r.data("placeholder"),n=r.data("mode"),g=r.data("post-data"),v={queryTokenizer:Bloodhound.tokenizers.whitespace,datumTokenizer:Bloodhound.tokenizers.obj.whitespace("label"),},m=r.data();function q(x,w){g.query=x;w.type="POST";w.data=g;w.isTagsInputCallback=true;return w}function i(w){return w}var k={itemValue:function(w){return w.value},itemText:function(w){return w.label},itemTitle:function(w){return w.title},typeaheadjs:[{highlight:m.highlight,minLength:m.highlight?0:1,hint:true,}],confirmKeys:[9,13,188],tagClass:function(w){return w.className?w.className:"label label-info"},};var h=d.extend({},k,m);switch(n){case"local":v.local=r.data("items");v.identify=function(w){return w.value};break;case"remote":v.remote={url:location.href,prepare:q,transform:i,rateLimitBy:"debounce",rateLimitWait:300,};break}var o=null;if(m.highlight&&r.data("highlights")){d.extend(v,{local:r.data("highlights")})}var t=new Bloodhound(v);t.initialize();function p(z,y,x){if(z===""){var w=o!==null?o.all():t.all();y(w)}else{t.search(z,y,x)}}h.typeaheadjs[1]={name:"options",displayKey:"label",source:p,};if(m.limit>0){h.typeaheadjs[1].limit=m.limit}var s=r.tagsinput(h);r.siblings(".bootstrap-tagsinput").addClass("tl_select");if(typeof u==="undefined"||u.length>0){r.tagsinput("input").attr("placeholder",u)}var j=r.tagsinput("input").width();if(r.is("select")){r.find("option:selected").each(function(){r.tagsinput("add",{value:this.value,label:this.text,className:this.className,title:this.value})})}r.tagsinput("input").on("keydown",function(w){if(w.keyCode==9){if(this.value!=""&&h.freeInput){r.tagsinput("add",{value:this.value,label:this.value,title:this.value})}w.preventDefault();if(typeof u==="undefined"||u.length>0){r.tagsinput("input").width(j)}}});if(r.data("submitonchange")=="1"){r.on("itemAdded",function(w){r.closest("form").submit()})}r.tagsinput("input").on("blur",function(w){if(this.value!=""&&h.freeInput){r.tagsinput("add",{value:this.value,label:this.value,title:this.value});this.value="";r.tagsinput("input").typeahead("val","");if(typeof u==="undefined"||u.length>0){r.tagsinput("input").width(j)}}});r.on("itemAdded",function(w){if(typeof u==="undefined"||u.length>0){r.tagsinput("input").val("")}});if(h.maxTags!=1){var l=new Sortable(r.prev(".bootstrap-tagsinput").get(0),{handle:".tag",onUpdate:function(x){var w=r.find("option");if(w.length){r.html(w.move(x.oldIndex,x.newIndex))}},})}})},setupTagList:function(){var f=d(this.config.selector);f.each(function(){var g=d(this);g.siblings(".tag-list").find("a").on("click",function(j){var h=d(this),i=g.siblings(".tl_select").find('[title="'+h.text()+'"]');j.preventDefault();if(i.length<1){g.closest("div").find(".tt-input").trigger("focus").val(h.text()).trigger(d.Event("keydown",{keyCode:9}))}else{i.find('[data-role="remove"]').trigger("click")}})})},};d.fn.move=function(h,f){while(h<0){h+=this.length}while(f<0){f+=this.length}if(f>=this.length){var g=f-this.length;while((g--)+1){this.push(undefined)}}this.splice(f,0,this.splice(h,1)[0]);return this};d(function(){c.init()});d(document).ajaxComplete(function(g,h,f){if(typeof f!="undefined"&&!f.isTagsInputCallback){c.ajaxComplete()}});if(window.MooTools){var a=[Request,Request.Contao,Request.HTML,Request.JSON],e={onSuccess:Request.prototype.onSuccess,onFailure:Request.prototype.onFailure,},b={onSuccess:function(){Request.Spy&&typeof Request.Spy=="function"&&Request.Spy.apply(this,arguments);e.onSuccess.apply(this,arguments);c.ajaxComplete()},onFailure:function(){Request.Spy&&typeof Request.Spy=="function"&&Request.Spy.apply(this,arguments);e.onFailure.apply(this,arguments)},};a.invoke("implement",b)}})(jQuery);