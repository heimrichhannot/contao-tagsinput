(function(d){var c={config:{selector:"select.tl_tagsinput, select.tagsinput, input.tl_tagsinput, input.tagsinput",},init:function(){this.setupTagsInput();this.setupTagList()},ajaxComplete:function(){this.setupTagsInput();this.setupTagList()},setupTagsInput:function(){var f=d(this.config.selector);f.each(function(){var q=d(this);if(q.data("tagsinput")){return true}var t=q.data("placeholder"),m=q.data("mode"),g=q.data("post-data"),u={queryTokenizer:Bloodhound.tokenizers.whitespace,datumTokenizer:Bloodhound.tokenizers.obj.whitespace("label"),},l=q.data();function p(w,v){g.query=w;v.type="POST";v.data=g;v.isTagsInputCallback=true;return v}function i(v){return v}var j={itemValue:function(v){return v.value},itemText:function(v){return v.label},itemTitle:function(v){return v.title},typeaheadjs:[{highlight:l.highlight,minLength:l.highlight?0:1,hint:true,}],confirmKeys:[9,13,188],tagClass:function(v){return v.className?v.className:"label label-info"},};var h=d.extend({},j,l);switch(m){case"local":u.local=q.data("items");u.identify=function(v){return v.value};break;case"remote":u.remote={url:location.href,prepare:p,transform:i,rateLimitBy:"debounce",rateLimitWait:300,};break}var n=null;if(l.highlight&&q.data("highlights")){d.extend(u,{local:q.data("highlights")})}var s=new Bloodhound(u);s.initialize();function o(y,x,w){if(y===""){var v=n!==null?n.all():s.all();x(v)}else{s.search(y,x,w)}}h.typeaheadjs[1]={name:"options",displayKey:"label",source:o,};if(l.limit>0){h.typeaheadjs[1].limit=l.limit}var r=q.tagsinput(h);q.siblings(".bootstrap-tagsinput").addClass("tl_select");if(typeof t==="undefined"||t.length>0){q.tagsinput("input").attr("placeholder",t)}if(q.is("select")){q.find("option:selected").each(function(){q.tagsinput("add",{value:this.value,label:this.text,className:this.className,title:this.value})})}q.tagsinput("input").on("keydown",function(v){if(v.keyCode==9){if(this.value!=""&&h.freeInput){q.tagsinput("add",{value:this.value,label:this.value,title:this.value})}v.preventDefault()}});if(q.data("submitonchange")=="1"){q.on("itemAdded",function(v){q.closest("form").submit()})}q.tagsinput("input").on("blur",function(v){if(this.value!=""&&h.freeInput){q.tagsinput("add",{value:this.value,label:this.value,title:this.value});this.value="";q.tagsinput("input").typeahead("val","")}});q.on("itemAdded",function(v){if(typeof t==="undefined"||t.length>0){q.tagsinput("input").val("")}});if(h.maxTags!=1){var k=new Sortable(q.prev(".bootstrap-tagsinput").get(0),{handle:".tag",onUpdate:function(w){var v=q.find("option");if(v.length){q.html(v.move(w.oldIndex,w.newIndex))}},})}})},setupTagList:function(){var f=d(this.config.selector);f.each(function(){var g=d(this);g.siblings(".tag-list").find("a").on("click",function(j){var h=d(this),i=g.siblings(".tl_select").find('[title="'+h.text()+'"]');j.preventDefault();if(i.length<1){g.closest("div").find(".tt-input").trigger("focus").val(h.text()).trigger(d.Event("keydown",{keyCode:9}))}else{i.find('[data-role="remove"]').trigger("click")}})})},};d.fn.move=function(h,f){while(h<0){h+=this.length}while(f<0){f+=this.length}if(f>=this.length){var g=f-this.length;while((g--)+1){this.push(undefined)}}this.splice(f,0,this.splice(h,1)[0]);return this};d(function(){c.init()});d(document).ajaxComplete(function(g,h,f){if(typeof f!="undefined"&&!f.isTagsInputCallback){c.ajaxComplete()}});if(window.MooTools){var a=[Request,Request.HTML,Request.JSON],e={onSuccess:Request.prototype.onSuccess,onFailure:Request.prototype.onFailure,},b={onSuccess:function(){Request.Spy&&typeof Request.Spy=="function"&&Request.Spy.apply(this,arguments);e.onSuccess.apply(this,arguments);c.ajaxComplete()},onFailure:function(){Request.Spy&&typeof Request.Spy=="function"&&Request.Spy.apply(this,arguments);e.onFailure.apply(this,arguments)},};if(typeof Request.Contao!=="undefined"){a.push(Request.Contao)}a.invoke("implement",b)}})(jQuery);