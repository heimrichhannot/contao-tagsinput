(function(b){var a={config:{selector:"select.tl_tagsinput, select.tagsinput, input.tl_tagsinput, input.tagsinput"},init:function(){this.setupTagsInput()},ajaxComplete:function(){this.setupTagsInput()},setupTagsInput:function(){var c=b(this.config.selector);c.each(function(){var m=b(this);if(m.data("tagsinput")){return true}var p=m.data("placeholder"),k=m.data("mode"),d=m.data("post-data"),q={queryTokenizer:Bloodhound.tokenizers.whitespace,datumTokenizer:Bloodhound.tokenizers.obj.whitespace("label"),limit:10},j=m.data();function l(s,r){d.query=s;r.type="POST";r.data=d;r.isTagsInputCallback=true;return r}function f(r){return r}var h={itemValue:function(r){return r.value},itemText:function(r){return r.label},itemTitle:function(r){return r.title},typeaheadjs:{name:"options",displayKey:"label",highlight:true,limit:10},confirmKeys:[9,13,188],tagClass:function(r){return r.className?r.className:"label label-info"}};var e=b.extend({},h,j);switch(k){case"local":q.local=m.data("items");q.identify=function(r){return r.value};break;case"remote":q.remote={url:location.href,prepare:l,transform:f,rateLimitBy:"debounce",rateLimitWait:300};break}var o=new Bloodhound(q);o.initialize();e.typeaheadjs.source=o.ttAdapter();var n=m.tagsinput(e);m.siblings(".bootstrap-tagsinput").addClass("tl_select");if(typeof p==="undefined"||p.length>0){m.tagsinput("input").attr("placeholder",p)}var g=m.tagsinput("input").width();if(m.is("select")){m.find("option:selected").each(function(){m.tagsinput("add",{value:this.value,label:this.text,className:this.className,title:this.value})})}m.tagsinput("input").on("keydown",function(r){if(r.keyCode==9){if(this.value!=""&&e.freeInput){m.tagsinput("add",{value:this.value,label:this.value,title:this.value})}r.preventDefault();if(typeof p==="undefined"||p.length>0){m.tagsinput("input").width(g)}}});if(m.data("submitonchange")=="1"){m.on("itemAdded",function(r){m.closest("form").submit()})}m.tagsinput("input").on("blur",function(r){if(this.value!=""&&e.freeInput){m.tagsinput("add",{value:this.value,label:this.value,title:this.value});this.value="";if(typeof p==="undefined"||p.length>0){m.tagsinput("input").width(g)}}});m.on("itemAdded",function(r){if(typeof p==="undefined"||p.length>0){m.tagsinput("input").val("")}});if(e.maxTags!=1){var i=new Sortable(m.prev(".bootstrap-tagsinput").get(0),{handle:".tag",onUpdate:function(s){var r=m.find("option");if(r.length){m.html(r.move(s.oldIndex,s.newIndex))}}})}})}};b.fn.move=function(e,c){while(e<0){e+=this.length}while(c<0){c+=this.length}if(c>=this.length){var d=c-this.length;while((d--)+1){this.push(undefined)}}this.splice(c,0,this.splice(e,1)[0]);return this};b(function(){a.init()});b(document).ajaxComplete(function(d,e,c){if(!c.isTagsInputCallback){a.ajaxComplete()}})})(jQuery);